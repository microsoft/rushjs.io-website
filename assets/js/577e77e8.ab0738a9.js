"use strict";(self.webpackChunkrushjs_io=self.webpackChunkrushjs_io||[]).push([[769],{158:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var a=n(6393);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=p(n),m=r,h=d["".concat(l,".").concat(m)]||d[m]||c[m]||o;return n?a.createElement(h,i(i({ref:t},u),{},{components:n})):a.createElement(h,i({ref:t},u))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:r,i[1]=s;for(var p=2;p<o;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},4658:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>p,toc:()=>d});var a=n(9122),r=n(2501),o=(n(6393),n(158)),i=["components"],s={title:"Everyday commands"},l=void 0,p={unversionedId:"pages/developer/everyday_commands",id:"pages/developer/everyday_commands",title:"Everyday commands",description:"Your daily workflow only needs a few Rush commands:",source:"@site/docs/pages/developer/everyday_commands.md",sourceDirName:"pages/developer",slug:"/pages/developer/everyday_commands",permalink:"/pages/developer/everyday_commands",draft:!1,editUrl:"https://github.com/microsoft/rushstack-websites/tree/main/websites/rushjs.io/docs/pages/developer/everyday_commands.md",tags:[],version:"current",frontMatter:{title:"Everyday commands"},sidebar:"docsSidebar",previous:{title:"Getting started as a developer",permalink:"/pages/developer/new_developer"},next:{title:"Modifying package.json",permalink:"/pages/developer/modifying_package_json"}},u={},d=[{value:"rush update",id:"rush-update",level:2},{value:"rush rebuild",id:"rush-rebuild",level:2},{value:"rushx",id:"rushx",level:2},{value:"rush check",id:"rush-check",level:2},{value:"rush change",id:"rush-change",level:2}],c={toc:d},m="wrapper";function h(e){var t=e.components,n=(0,r.Z)(e,i);return(0,o.kt)(m,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Your daily workflow only needs a few Rush commands:"),(0,o.kt)("h2",{id:"rush-update"},"rush update"),(0,o.kt)("p",null,"Remember to run ",(0,o.kt)("inlineCode",{parentName:"p"},"rush update")," whenever a ",(0,o.kt)("strong",{parentName:"p"},"package.json")," file has changed. In other words:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"After pulling new changes from git (e.g. ",(0,o.kt)("inlineCode",{parentName:"li"},"git pull"),")"),(0,o.kt)("li",{parentName:"ul"},"After manually editing any project's ",(0,o.kt)("strong",{parentName:"li"},"package.json")," file in any way"),(0,o.kt)("li",{parentName:"ul"},"After editing any ",(0,o.kt)("strong",{parentName:"li"},"common/config")," files that affect versions (e.g. ",(0,o.kt)("strong",{parentName:"li"},"pnpmfile.js"),", ",(0,o.kt)("strong",{parentName:"li"},"common-versions.json"),", etc.)")),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"rush update")," operation may change some files under ",(0,o.kt)("strong",{parentName:"p"},"common/config"),". If so, you should commit those changes to Git and include them in your PR. When in doubt, run ",(0,o.kt)("inlineCode",{parentName:"p"},"rush update")," -- if everything is already up to date, it won't take any time!"),(0,o.kt)("p",null,"What ",(0,o.kt)("inlineCode",{parentName:"p"},"rush update")," does:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Rush checks/applies various policies that sometimes update files under ",(0,o.kt)("strong",{parentName:"li"},"common/config"),"."),(0,o.kt)("li",{parentName:"ol"},"Rush compares all of your project ",(0,o.kt)("strong",{parentName:"li"},"package.json")," files against the repository's common shrinkwrap file to see if it's valid."),(0,o.kt)("li",{parentName:"ol"},"If it's outdated, the package manager updates the shrinkwrap file."),(0,o.kt)("li",{parentName:"ol"},"Either way, the package manager installs all dependencies into the ",(0,o.kt)("strong",{parentName:"li"},"common/temp/node_modules")," folder."),(0,o.kt)("li",{parentName:"ol"},"Finally, Rush constructs a local ",(0,o.kt)("strong",{parentName:"li"},"node_modules")," folder for each project, by making symlinks into ",(0,o.kt)("strong",{parentName:"li"},"common/temp/node_modules"),". (This is the same operation as ",(0,o.kt)("inlineCode",{parentName:"li"},"rush link"),".)")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},'What is this "shrinkwrap file"?')),(0,o.kt)("p",{parentName:"blockquote"},"Most projects don't specify an exact version such as ",(0,o.kt)("inlineCode",{parentName:"p"},"1.2.3")," for a dependency, but instead specify SemVer range such as ",(0,o.kt)("inlineCode",{parentName:"p"},"1.x")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"^1.2.3"),". By itself, this would mean that what gets installed depends on the latest version at the time. Such ",(0,o.kt)("strong",{parentName:"p"},"nondeterminism")," is bad: It would be maddening for a Git branch that built on Monday to mysteriously be failing on Tuesday because of a new release of a library. The shrinkwrap file solves this problem by storing a complete installation plan in a large file that is tracked by Git."),(0,o.kt)("p",{parentName:"blockquote"},"The shrinkwrap file has different names depending on the ",(0,o.kt)("a",{parentName:"p",href:"/pages/maintainer/package_managers"},"package manager")," that your repo is using: ",(0,o.kt)("strong",{parentName:"p"},"shrinkwrap.yaml"),", ",(0,o.kt)("strong",{parentName:"p"},"npm-shrinkwrap.json"),", or ",(0,o.kt)("strong",{parentName:"p"},"yarn.lock"))),(0,o.kt)("p",null,"You will notice that automated CI jobs use ",(0,o.kt)("inlineCode",{parentName:"p"},"rush install")," instead of ",(0,o.kt)("inlineCode",{parentName:"p"},"rush update"),". The difference is that ",(0,o.kt)("inlineCode",{parentName:"p"},"rush install")," won't update any files. Instead, it will fail your PR build if something is out of date, to let you know that you forgot to run ",(0,o.kt)("inlineCode",{parentName:"p"},"rush update")," or forgot to commit the result. (Some people choose to use ",(0,o.kt)("inlineCode",{parentName:"p"},"rush install")," as their everyday command, in order to catch unintended changes to the shrinkwrap file.)"),(0,o.kt)("h2",{id:"rush-rebuild"},"rush rebuild"),(0,o.kt)("p",null,"Once you've pulled the latest changes, it's time to compile everything. ",(0,o.kt)("inlineCode",{parentName:"p"},"rush rebuild")," does a full, clean build of every project in the repository."),(0,o.kt)("p",null,"If your toolchain supports incremental builds, you can also use ",(0,o.kt)("inlineCode",{parentName:"p"},"rush build")," to build only the projects that have changed."),(0,o.kt)("h2",{id:"rushx"},"rushx"),(0,o.kt)("p",null,"If you want to build just one project, you can use the ",(0,o.kt)("inlineCode",{parentName:"p"},"rushx")," command. You run it under the project folder that you want to operate on. The ",(0,o.kt)("inlineCode",{parentName:"p"},"rushx")," command is analogous to ",(0,o.kt)("inlineCode",{parentName:"p"},"npm run"),", but with slightly less typing, slightly better error reporting, and command-line help."),(0,o.kt)("h2",{id:"rush-check"},"rush check"),(0,o.kt)("p",null,"After editing a ",(0,o.kt)("strong",{parentName:"p"},"package.json")," file, you can run ",(0,o.kt)("inlineCode",{parentName:"p"},"rush check")," to see if multiple projects are depending on different versions of the same library. In a monorepo environment, that is undesirable. Many repos will use ",(0,o.kt)("inlineCode",{parentName:"p"},"rush check")," as a CI build step, so they can fail your PR build if you introduce side-by-side versions."),(0,o.kt)("h2",{id:"rush-change"},"rush change"),(0,o.kt)("p",null,"If you work on libraries that get published as NPM packages, your repo probably requires you to include change log entries as part of your PR. You will know because your PR build will fail on the ",(0,o.kt)("inlineCode",{parentName:"p"},"rush change --verify")," step."),(0,o.kt)("p",null,"To write change logs, first commit any pending work to Git. Then type ",(0,o.kt)("inlineCode",{parentName:"p"},"rush change")," from anywhere under your repo working folder. This command will examine your Git history to determine which project folders have diffs. Based on that, it will prompt you to write a change log entry for each one. Each change log entry gets stored in a separate file under ",(0,o.kt)("strong",{parentName:"p"},"common/changes"),". You should add and commit these files to Git."),(0,o.kt)("p",null,"Later, Rush's automated publishing workflow will inspect these files to determine which packages need to be published. It will delete the files and copy your messages into the package's CHANGELOG.md file."),(0,o.kt)("p",null,"\ud83d\udc49 See ",(0,o.kt)("a",{parentName:"p",href:"/pages/best_practices/change_logs"},"Authoring change logs")," for tips about writing change logs."),(0,o.kt)("h1",{id:"common-scenarios"},"Common scenarios"),(0,o.kt)("p",null,"That's it! Those are all the commonly used Rush commands."),(0,o.kt)("p",null,"Combining everything, a typical daily incantation might look like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'# Pull the latest changes from Git\ngit pull\n\n# Install NPM packages as needed\nrush update\n\n# Do a clean rebuild of everything\nrush rebuild\n\n# Work on one project\ncd ./my-project\n\n# Let\'s assume there is a "start" script in the package.json.\n# (To see the available commands, type "rushx" by itself.)\nrushx start\n')))}h.isMDXComponent=!0}}]);