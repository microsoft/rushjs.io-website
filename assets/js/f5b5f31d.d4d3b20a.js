"use strict";(self.webpackChunkrushjs_io=self.webpackChunkrushjs_io||[]).push([[8848],{158:(e,t,n)=>{n.d(t,{Zo:()=>o,kt:()=>c});var a=n(6393);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=a.createContext({}),p=function(e){var t=a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},o=function(e){var t=p(e.components);return a.createElement(u.Provider,{value:t},e.children)},g="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,u=e.parentName,o=s(e,["components","mdxType","originalType","parentName"]),g=p(n),m=r,c=g["".concat(u,".").concat(m)]||g[m]||h[m]||i;return n?a.createElement(c,l(l({ref:t},o),{},{components:n})):a.createElement(c,l({ref:t},o))}));function c(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=m;var s={};for(var u in t)hasOwnProperty.call(t,u)&&(s[u]=t[u]);s.originalType=e,s[g]="string"==typeof e?e:r,l[1]=s;for(var p=2;p<i;p++)l[p]=n[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},1792:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>u,default:()=>c,frontMatter:()=>s,metadata:()=>p,toc:()=>g});var a=n(9122),r=n(2501),i=(n(6393),n(158)),l=["components"],s={title:"Using Rush plugins (experimental)"},u=void 0,p={unversionedId:"pages/maintainer/using_rush_plugins",id:"pages/maintainer/using_rush_plugins",title:"Using Rush plugins (experimental)",description:"Rush plugins enable you to:",source:"@site/docs/pages/maintainer/using_rush_plugins.md",sourceDirName:"pages/maintainer",slug:"/pages/maintainer/using_rush_plugins",permalink:"/pages/maintainer/using_rush_plugins",draft:!1,editUrl:"https://github.com/microsoft/rushstack-websites/tree/main/websites/rushjs.io/docs/pages/maintainer/using_rush_plugins.md",tags:[],version:"current",frontMatter:{title:"Using Rush plugins (experimental)"},sidebar:"docsSidebar",previous:{title:"Autoinstallers",permalink:"/pages/maintainer/autoinstallers"},next:{title:"Publishing packages",permalink:"/pages/maintainer/publishing"}},o={},g=[{value:"Enabling a Rush plugin",id:"enabling-a-rush-plugin",level:2},{value:"Step 1: Configure an autoinstaller",id:"step-1-configure-an-autoinstaller",level:3},{value:"Step 2: Update rush-plugins.json",id:"step-2-update-rush-pluginsjson",level:3},{value:"Step 3: Optional config file",id:"step-3-optional-config-file",level:3},{value:"First-party plugins",id:"first-party-plugins",level:2},{value:"Third-party plugins",id:"third-party-plugins",level:2},{value:"See also",id:"see-also",level:2}],h={toc:g},m="wrapper";function c(e){var t=e.components,n=(0,r.Z)(e,l);return(0,i.kt)(m,(0,a.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Rush plugins enable you to:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Share common Rush configuration across multiple monorepos"),(0,i.kt)("li",{parentName:"ul"},"Extend Rush's base functionality with custom features"),(0,i.kt)("li",{parentName:"ul"},"Prototype new feature ideas before officially contributing them to Rush")),(0,i.kt)("p",null,"Plugins are distributed via an NPM package, which we call a ",(0,i.kt)("strong",{parentName:"p"},"plugin package"),". A single\npackage may define one or more Rush plugins. (If you are interested in creating your plugin package,\nsee the article ",(0,i.kt)("a",{parentName:"p",href:"/pages/extensibility/creating_plugins"},"Creating rush plugins"),".)"),(0,i.kt)("h2",{id:"enabling-a-rush-plugin"},"Enabling a Rush plugin"),(0,i.kt)("p",null,"There are three steps for enabling a Rush plugin in your monorepo. For this tutorial,\nlet's configure a hypothetical plugin called ",(0,i.kt)("inlineCode",{parentName:"p"},'"example"')," that is provided by the NPM package\n",(0,i.kt)("inlineCode",{parentName:"p"},"@your-company/rush-example-plugin"),"."),(0,i.kt)("h3",{id:"step-1-configure-an-autoinstaller"},"Step 1: Configure an autoinstaller"),(0,i.kt)("p",null,"Plugins rely on Rush's ",(0,i.kt)("a",{parentName:"p",href:"/pages/maintainer/autoinstallers"},"autoinstaller")," feature for on-demand\ninstallation of their NPM package."),(0,i.kt)("p",null,"Here's how to create a new autoinstaller called ",(0,i.kt)("inlineCode",{parentName:"p"},"rush-plugins"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"rush init-autoinstaller --name rush-plugins\n")),(0,i.kt)("p",null,"This will create an autoinstaller ",(0,i.kt)("strong",{parentName:"p"},"package.json")," file. Add your plugin's NPM package as a dependency:"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"common/autoinstallers/rush-plugins/package.json")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'{\n  "name": "rush-plugins",\n  "version": "1.0.0",\n  "private": true,\n  "dependencies": {\n    "@your-company/rush-example-plugin": "^1.0.0"  \ud83d\udc48 \ud83d\udc48 \ud83d\udc48\n  }\n}\n')),(0,i.kt)("p",null,"Next, generate the shrinkwrap file:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# Creates the shrinkwrap file common/autoinstallers/rush-plugins/pnpm-lock.yaml\nrush update-autoinstaller --name rush-plugins\n")),(0,i.kt)("p",null,"Commit these files to Git."),(0,i.kt)("h3",{id:"step-2-update-rush-pluginsjson"},"Step 2: Update rush-plugins.json"),(0,i.kt)("p",null,"In order for the plugin to be loaded, we need to register it in ",(0,i.kt)("strong",{parentName:"p"},"rush-plugins.json"),".\nContinuing our example:"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"common/config/rush/rush-plugins.json")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'{\n  "$schema": "https://developer.microsoft.com/json-schemas/rush/v5/rush-plugins.schema.json",\n  "plugins": [\n    /**\n     * Each item defines a plugin to be loaded by Rush.\n     */\n    {\n      /**\n       * The name of the NPM package that provides the plugin.\n       */\n      "packageName": "@your-company/rush-example-plugin",\n\n      /**\n       * The name of the plugin.  This can be found in the "pluginName"\n       * field of the "rush-plugin-manifest.json" file in the NPM package folder.\n       */\n      "pluginName": "example",\n\n      /**\n       * The name of a Rush autoinstaller that will be used for installation, which\n       * can be created using "rush init-autoinstaller".  Add the plugin\'s NPM package\n       * to the package.json "dependencies" of your autoinstaller, then run\n       * "rush update-autoinstaller".\n       */\n      "autoinstallerName": "rush-plugins"\n    }\n  ]\n}\n')),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"pluginName")," field can be found in the\n",(0,i.kt)("a",{parentName:"p",href:"/pages/configs/rush-plugin-manifest_json"},"rush-plugin-manifest.json"),"\nof the plugin package."),(0,i.kt)("h3",{id:"step-3-optional-config-file"},"Step 3: Optional config file"),(0,i.kt)("p",null,"Some plugins can be customized via their own config file; if so, their\n",(0,i.kt)("strong",{parentName:"p"},"rush-plugin-manifest.json")," will specify the ",(0,i.kt)("inlineCode",{parentName:"p"},"optionsSchema")," field."),(0,i.kt)("p",null,"The config filename will have the same as the ",(0,i.kt)("inlineCode",{parentName:"p"},"pluginName"),", for example:"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"common/config/rush-plugins/example.json")),(0,i.kt)("h2",{id:"first-party-plugins"},"First-party plugins"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"NPM Package"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/microsoft/rushstack/tree/main/rush-plugins/rush-amazon-s3-build-cache-plugin"},"@rushstack/rush-amazon-s3-build-cache-plugin")),(0,i.kt)("td",{parentName:"tr",align:null},"Cloud build cache provider for Amazon S3")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/microsoft/rushstack/tree/main/rush-plugins/rush-azure-storage-build-cache-plugin"},"@rushstack/rush-azure-storage-build-cache-plugin")),(0,i.kt)("td",{parentName:"tr",align:null},"Cloud build cache provider for Azure Storage")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/microsoft/rushstack/tree/main/rush-plugins/rush-serve-plugin"},"@rushstack/rush-serve-plugin")),(0,i.kt)("td",{parentName:"tr",align:null},"(Experimental) A Rush plugin that hooks into action execution and runs an express server to serve project outputs")))),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},(0,i.kt)("strong",{parentName:"p"},"NOTE:")," The ",(0,i.kt)("inlineCode",{parentName:"p"},"@rushstack/rush-amazon-s3-build-cache-plugin")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"@rushstack/rush-azure-storage-build-cache-plugin"),"\npackages are currently built-in to Rush and enabled automatically. For now, you should NOT register them\nin ",(0,i.kt)("strong",{parentName:"p"},"rush-plugins.json"),"."),(0,i.kt)("p",{parentName:"blockquote"},"This is a temporary accommodation while the plugin framework is still experimental.\nIn the next major release of Rush, the build cache packages will need to be configured in standard way.")),(0,i.kt)("h2",{id:"third-party-plugins"},"Third-party plugins"),(0,i.kt)("p",null,"Here's a gallery of some community contributed plugins."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"NPM Package"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/bytesfriends/rush-plugins/tree/main/rush-plugins/rush-archive-project-plugin"},"rush-archive-project-plugin")),(0,i.kt)("td",{parentName:"tr",align:null},"Archive Rush projects that are no longer maintained")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/gigara/rush-github-action-build-cache-plugin"},"rush-github-action-build-cache-plugin")),(0,i.kt)("td",{parentName:"tr",align:null},"Save and restore the build cache in Github actions")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/bytesfriends/rush-plugins/tree/main/rush-plugins/rush-init-project-plugin"},"rush-init-project-plugin")),(0,i.kt)("td",{parentName:"tr",align:null},"Initialize new Rush projects")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/bytesfriends/rush-plugins/tree/main/rush-plugins/rush-lint-staged-plugin"},"rush-lint-staged-plugin")),(0,i.kt)("td",{parentName:"tr",align:null},"Integrate ",(0,i.kt)("a",{parentName:"td",href:"https://www.npmjs.com/package/lint-staged"},"lint-staged")," with a Rush monorepo")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/bytesfriends/rush-plugins/tree/main/rush-plugins/rush-print-log-if-error-plugin"},"rush-print-log-if-error-plugin")),(0,i.kt)("td",{parentName:"tr",align:null},"Print a project's entire log file when an error occurs")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/bytesfriends/rush-plugins/tree/main/rush-plugins/rush-sort-package-json"},"rush-sort-package-json")),(0,i.kt)("td",{parentName:"tr",align:null},"Sort the package.json file entries for Rush projects")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://github.com/bytesfriends/rush-plugins/tree/main/rush-plugins/rush-upgrade-self-plugin"},"rush-upgrade-self-plugin")),(0,i.kt)("td",{parentName:"tr",align:null},"A helper for upgrading to the latest release of Rush")))),(0,i.kt)("p",null,"If you created an interesting plugin for Rush, let us know in a GitHub issue. Thanks!"),(0,i.kt)("h2",{id:"see-also"},"See also"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/pages/commands/rush_init-autoinstaller"},"rush init-autoinstaller")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/pages/commands/rush_update-autoinstaller"},"rush update-autoinstaller")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/pages/extensibility/creating_plugins"},"Creating a Rush plugin"))))}c.isMDXComponent=!0}}]);